# Адаптер Blade to Chunk

Задача адаптера подготовить данные для работы десктопного клиента с чанками (умный элемент) и записать их базу данных.

## Принцип работы

- получить запись о чанке из новой базы данных используя идентификатор чанка;
- подготовить данные для работы с ними десктопного клиента;
- сохранить адаптированные данные в старую базу данных.

## Описание методов адаптера

Работа адаптера запускается методом `run()`, который в качестве аргумента принимает идентификатор `$id` необходимого чанка

```php
public function run($id = null): void
```

В этом же методе происходит проверка идентификатора на `null`, если не возникает исключения, то выполняется следующий метод `reformat()`, в качестве аргумента принимает объект чанка `$chunk`.

```php
public function reformat(ReChunk $chunk): void
```

Объект чанка получаем в методе `find()`, используя идентификатор чанка `$id`

```php
public function find($id): ReChunk
```

Метод `reformat()` полученный объект преобразует в массив и записует в свойство `$config` Адаптера.

Следующее, что необходимо сделать, преобразовать json массив, записанный  в свойстве `config['body']` в строку параметров понятных десктопному клиенту.
Для этого используется метод `toString()` в него передаем json массив `$options`.

```php
public function toString(string $options): string
```

Для разбора свойства `$options['properties']` используется дополнительная функция `translate()`

```php
public function translate(array $properties): int
```

На данном этапе все данные преобразованы и записаны в свойстве Адаптера `$config`, вызывается последний метод `save()`.

```php
public function save(): void
```

Он выполянет проверку на существование записи в старой базе данных. Если запись имеется, то она просто обновляется на новые данные, иначе создается новая запись чанка.






